<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2113.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #4689cc; -webkit-text-stroke: #4689cc}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #8cd3fe; -webkit-text-stroke: #8cd3fe}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #c27e65; -webkit-text-stroke: #c27e65}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #71c083; -webkit-text-stroke: #71c083}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca; min-height: 16.0px}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6d7378; -webkit-text-stroke: #6d7378}
    span.s1 {font-kerning: none; background-color: #171818}
    span.s2 {font-kerning: none; color: #8cd3fe; background-color: #171818; -webkit-text-stroke: 0px #8cd3fe}
    span.s3 {font-kerning: none; color: #6d6d6d; background-color: #171818; -webkit-text-stroke: 0px #6d6d6d}
    span.s4 {font-kerning: none; color: #cacaca; background-color: #171818; -webkit-text-stroke: 0px #cacaca}
    span.s5 {font-kerning: none; color: #c27e65; background-color: #171818; -webkit-text-stroke: 0px #c27e65}
    span.s6 {font-kerning: none; color: #4689cc; background-color: #171818; -webkit-text-stroke: 0px #4689cc}
    span.s7 {font-kerning: none; color: #b76ff7; background-color: #171818; -webkit-text-stroke: 0px #b76ff7}
    span.s8 {font-kerning: none; color: #d4d4d4; background-color: #171818; -webkit-text-stroke: 0px #d4d4d4}
    span.s9 {font-kerning: none; color: #71c083; background-color: #171818; -webkit-text-stroke: 0px #71c083}
    span.s10 {font-kerning: none}
    span.s11 {font-kerning: none; color: #36c0a0; background-color: #171818; -webkit-text-stroke: 0px #36c0a0}
    span.s12 {font-kerning: none; color: #f67c30; background-color: #171818; -webkit-text-stroke: 0px #f67c30}
    span.s13 {font-kerning: none; color: #6d7378; background-color: #171818; -webkit-text-stroke: 0px #6d7378}
    span.s14 {font-kerning: none; color: #a7c598; background-color: #171818; -webkit-text-stroke: 0px #a7c598}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE</span><span class="s2"> html</span><span class="s1">&gt;</span></p>
<p class="p1"><span class="s3">&lt;</span><span class="s1">html</span><span class="s4"> </span><span class="s2">lang</span><span class="s3">=</span><span class="s5">"it"</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s1">charset</span><span class="s3">=</span><span class="s5">"UTF-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"viewport"</span><span class="s4"> </span><span class="s2">content</span><span class="s3">=</span><span class="s1">"width=device-width, initial-scale=1.0"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">title</span><span class="s3">&gt;</span><span class="s1">Bocce Performance Tracker</span><span class="s3">&lt;/</span><span class="s6">title</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdn.tailwindcss.com"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"module"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s7">import</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> initializeApp </span><span class="s8">}</span><span class="s4"> </span><span class="s7">from</span><span class="s4"> </span><span class="s1">"https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js"</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">import</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> getAuth</span><span class="s8">,</span><span class="s1"> signInAnonymously</span><span class="s8">,</span><span class="s1"> signInWithCustomToken </span><span class="s8">}</span><span class="s1"> </span><span class="s7">from</span><span class="s1"> </span><span class="s9">"https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js"</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">import</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> getFirestore</span><span class="s8">,</span><span class="s1"> doc</span><span class="s8">,</span><span class="s1"> getDoc</span><span class="s8">,</span><span class="s1"> setDoc</span><span class="s8">,</span><span class="s1"> onSnapshot</span><span class="s8">,</span><span class="s1"> collection</span><span class="s8">,</span><span class="s1"> addDoc</span><span class="s8">,</span><span class="s1"> updateDoc</span><span class="s8">,</span><span class="s1"> getDocs </span><span class="s8">}</span><span class="s1"> </span><span class="s7">from</span><span class="s1"> </span><span class="s9">"https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js"</span><span class="s8">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Variabili globali fornite dall'ambiente Canvas</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">const</span><span class="s1"> appId </span><span class="s8">=</span><span class="s1"> </span><span class="s7">typeof</span><span class="s1"> __app_id </span><span class="s8">!==</span><span class="s1"> </span><span class="s9">'undefined'</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> __app_id </span><span class="s8">:</span><span class="s1"> </span><span class="s9">'default-app-id'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">const</span><span class="s1"> firebaseConfig </span><span class="s8">=</span><span class="s1"> </span><span class="s7">typeof</span><span class="s1"> __firebase_config </span><span class="s8">!==</span><span class="s1"> </span><span class="s9">'undefined'</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s11">JSON</span><span class="s8">.</span><span class="s1">parse</span><span class="s8">(</span><span class="s1">__firebase_config</span><span class="s8">)</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s8">{};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">const</span><span class="s1"> initialAuthToken </span><span class="s8">=</span><span class="s1"> </span><span class="s7">typeof</span><span class="s1"> __initial_auth_token </span><span class="s8">!==</span><span class="s1"> </span><span class="s9">'undefined'</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> __initial_auth_token </span><span class="s8">:</span><span class="s1"> </span><span class="s7">null</span><span class="s8">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Inizializza Firebase</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">let</span><span class="s1"> app</span><span class="s8">,</span><span class="s1"> db</span><span class="s8">,</span><span class="s1"> auth</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">try</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>app </span><span class="s8">=</span><span class="s1"> initializeApp</span><span class="s8">(</span><span class="s1">firebaseConfig</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>db </span><span class="s8">=</span><span class="s1"> getFirestore</span><span class="s8">(</span><span class="s1">app</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>auth </span><span class="s8">=</span><span class="s1"> getAuth</span><span class="s8">(</span><span class="s1">app</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s8">.</span><span class="s4">log</span><span class="s8">(</span><span class="s1">"Firebase inizializzato correttamente."</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">catch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s8">.</span><span class="s4">error</span><span class="s8">(</span><span class="s1">"Errore nell'inizializzazione di Firebase:"</span><span class="s8">,</span><span class="s4"> e</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s4">getElementById</span><span class="s8">(</span><span class="s1">'message-box'</span><span class="s8">).</span><span class="s4">innerHTML </span><span class="s8">=</span><span class="s4"> </span><span class="s1">`&lt;p class="text-red-600"&gt;Errore nell'inizializzazione di Firebase. Controllare la configurazione.&lt;/p&gt;`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">let</span><span class="s1"> currentSessionId </span><span class="s8">=</span><span class="s1"> </span><span class="s7">null</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">let</span><span class="s1"> userId </span><span class="s8">=</span><span class="s1"> </span><span class="s7">null</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">let</span><span class="s1"> unsubscribeFromGame </span><span class="s8">=</span><span class="s1"> </span><span class="s7">null</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">let</span><span class="s1"> latestSessionData </span><span class="s8">=</span><span class="s1"> </span><span class="s7">null</span><span class="s8">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>window</span><span class="s8">.</span><span class="s1">onload </span><span class="s8">=</span><span class="s1"> </span><span class="s7">async</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">await</span><span class="s1"> authenticateUser</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>setupEventListeners</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>renderSessionList</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">};</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">async</span><span class="s1"> </span><span class="s7">function</span><span class="s1"> authenticateUser</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">try</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">initialAuthToken</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">await</span><span class="s1"> signInWithCustomToken</span><span class="s8">(</span><span class="s1">auth</span><span class="s8">,</span><span class="s1"> initialAuthToken</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">else</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">await</span><span class="s1"> signInAnonymously</span><span class="s8">(</span><span class="s1">auth</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>userId </span><span class="s8">=</span><span class="s1"> auth</span><span class="s8">.</span><span class="s1">currentUser</span><span class="s8">.</span><span class="s1">uid</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'user-id-display'</span><span class="s8">).</span><span class="s1">innerText </span><span class="s8">=</span><span class="s1"> </span><span class="s9">`ID utente: </span><span class="s8">${</span><span class="s1">userId</span><span class="s8">}</span><span class="s9">`</span><span class="s8">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s8">.</span><span class="s4">log</span><span class="s8">(</span><span class="s1">"Autenticazione riuscita. ID utente:"</span><span class="s8">,</span><span class="s4"> userId</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">catch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">error</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>console</span><span class="s8">.</span><span class="s1">error</span><span class="s8">(</span><span class="s9">"Errore di autenticazione:"</span><span class="s8">,</span><span class="s1"> error</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s4">getElementById</span><span class="s8">(</span><span class="s1">'message-box'</span><span class="s8">).</span><span class="s4">innerHTML </span><span class="s8">=</span><span class="s4"> </span><span class="s1">`&lt;p class="text-red-600"&gt;Errore di autenticazione. Riprova più tardi.&lt;/p&gt;`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">function</span><span class="s1"> setupEventListeners</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'start-new-session-btn'</span><span class="s8">).</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'click'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'session-form-modal'</span><span class="s8">).</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(</span><span class="s9">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'close-modal-btn'</span><span class="s8">).</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'click'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'session-form-modal'</span><span class="s8">).</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s9">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'close-play-modal-btn'</span><span class="s8">).</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'click'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'play-form-modal'</span><span class="s8">).</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s9">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'start-next-phase-btn'</span><span class="s8">).</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'click'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>startNextPhase</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'back-to-sessions-btn'</span><span class="s8">).</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'click'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">unsubscribeFromGame</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>unsubscribeFromGame</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>unsubscribeFromGame </span><span class="s8">=</span><span class="s1"> </span><span class="s7">null</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'game-view'</span><span class="s8">).</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s9">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'session-list-view'</span><span class="s8">).</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(</span><span class="s9">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>renderSessionList</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'cancel-phase-btn'</span><span class="s8">).</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'click'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>cancelPhase</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'session-form'</span><span class="s8">).</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'submit'</span><span class="s8">,</span><span class="s1"> handleSessionFormSubmit</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'game-type'</span><span class="s8">).</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'change'</span><span class="s8">,</span><span class="s1"> updatePlayerInputs</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'play-form'</span><span class="s8">).</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'submit'</span><span class="s8">,</span><span class="s1"> handlePlayFormSubmit</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'play-type'</span><span class="s8">).</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'change'</span><span class="s8">,</span><span class="s1"> updatePlayForm</span><span class="s8">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Nuovi event listener per l'esportazione</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'export-csv-btn'</span><span class="s8">).</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'click'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> exportToCSV</span><span class="s8">(</span><span class="s1">latestSessionData</span><span class="s8">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'export-pdf-btn'</span><span class="s8">).</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'click'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> exportToPDF</span><span class="s8">());</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">function</span><span class="s1"> updatePlayForm</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> playType </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'play-type'</span><span class="s8">).</span><span class="s1">value</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> detailsContainer </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'play-details'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> fieldSectorSelect </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'play-field-sector'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> currentFieldSector </span><span class="s8">=</span><span class="s1"> latestSessionData </span><span class="s8">?</span><span class="s1"> latestSessionData</span><span class="s8">.</span><span class="s1">currentFieldSector </span><span class="s8">:</span><span class="s1"> </span><span class="s7">null</span><span class="s8">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>detailsContainer</span><span class="s8">.</span><span class="s1">innerHTML </span><span class="s8">=</span><span class="s1"> </span><span class="s9">''</span><span class="s8">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Il campo del settore è sempre abilitato, l'utente può cambiarlo a piacimento.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>fieldSectorSelect</span><span class="s8">.</span><span class="s1">disabled </span><span class="s8">=</span><span class="s1"> </span><span class="s7">false</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>fieldSectorSelect</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(</span><span class="s9">'bg-gray-200'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">currentFieldSector</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>fieldSectorSelect</span><span class="s8">.</span><span class="s1">value </span><span class="s8">=</span><span class="s1"> currentFieldSector</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">else</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>fieldSectorSelect</span><span class="s8">.</span><span class="s1">value </span><span class="s8">=</span><span class="s1"> </span><span class="s9">""</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">playType </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'accosto'</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>detailsContainer</span><span class="s8">.</span><span class="s1">innerHTML </span><span class="s8">=</span><span class="s1"> </span><span class="s9">`</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;label class="block text-gray-700 font-bold mb-2"&gt;Distanza dal pallino (cm):&lt;/label&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;input type="number" name="distance" class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">else</span><span class="s1"> </span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">playType</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>detailsContainer</span><span class="s8">.</span><span class="s1">innerHTML </span><span class="s8">=</span><span class="s1"> </span><span class="s9">`</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;label class="block text-gray-700 font-bold mb-2"&gt;Direzione:&lt;/label&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;select name="direction" class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 mb-4" required&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;option value=""&gt;Seleziona&lt;/option&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;option value="DX"&gt;DX&lt;/option&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;option value="SX"&gt;SX&lt;/option&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;option value="C"&gt;Centrale&lt;/option&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/select&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;label class="block text-gray-700 font-bold mb-2"&gt;Esito:&lt;/label&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;select name="result" class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;option value=""&gt;Seleziona&lt;/option&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;option value="hit"&gt;Colpita&lt;/option&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;option value="miss"&gt;Sbagliata&lt;/option&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/select&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">function</span><span class="s1"> updatePlayerInputs</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> gameType </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'game-type'</span><span class="s8">).</span><span class="s1">value</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> playerInputsContainer </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'player-inputs'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>playerInputsContainer</span><span class="s8">.</span><span class="s1">innerHTML </span><span class="s8">=</span><span class="s1"> </span><span class="s9">''</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">let</span><span class="s1"> playerCount </span><span class="s8">=</span><span class="s1"> </span><span class="s12">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">switch</span><span class="s8">(</span><span class="s1">gameType</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">case</span><span class="s1"> </span><span class="s9">'1vs1'</span><span class="s8">:</span><span class="s1"> playerCount </span><span class="s8">=</span><span class="s1"> </span><span class="s12">2</span><span class="s8">;</span><span class="s1"> </span><span class="s7">break</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">case</span><span class="s1"> </span><span class="s9">'2vs2'</span><span class="s8">:</span><span class="s1"> playerCount </span><span class="s8">=</span><span class="s1"> </span><span class="s12">4</span><span class="s8">;</span><span class="s1"> </span><span class="s7">break</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">case</span><span class="s1"> </span><span class="s9">'3vs3'</span><span class="s8">:</span><span class="s1"> playerCount </span><span class="s8">=</span><span class="s1"> </span><span class="s12">6</span><span class="s8">;</span><span class="s1"> </span><span class="s7">break</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">for</span><span class="s8">(</span><span class="s7">let</span><span class="s1"> i </span><span class="s8">=</span><span class="s1"> </span><span class="s12">1</span><span class="s8">;</span><span class="s1"> i </span><span class="s8">&lt;=</span><span class="s1"> playerCount</span><span class="s8">;</span><span class="s1"> i</span><span class="s8">++)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> team </span><span class="s8">=</span><span class="s1"> i </span><span class="s8">&lt;=</span><span class="s1"> playerCount </span><span class="s8">/</span><span class="s1"> </span><span class="s12">2</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s9">'Squadra 1'</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s9">'Squadra 2'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>playerInputsContainer</span><span class="s8">.</span><span class="s1">innerHTML </span><span class="s8">+=</span><span class="s1"> </span><span class="s9">`</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="flex items-center space-x-2"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;input type="text" id="player-name-</span><span class="s8">${</span><span class="s4">i</span><span class="s8">}</span><span class="s1">" placeholder="Nome Atleta </span><span class="s8">${</span><span class="s4">i</span><span class="s8">}</span><span class="s1">" class="p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 w-2/3" required&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;input type="hidden" id="player-team-</span><span class="s8">${</span><span class="s4">i</span><span class="s8">}</span><span class="s1">" value="</span><span class="s8">${</span><span class="s4">team</span><span class="s8">}</span><span class="s1">"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;span class="text-gray-600 text-sm font-bold w-1/3"&gt;</span><span class="s8">${</span><span class="s4">team</span><span class="s8">}</span><span class="s1">&lt;/span&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">function</span><span class="s1"> showMessage</span><span class="s8">(</span><span class="s1">text</span><span class="s8">,</span><span class="s1"> isError </span><span class="s8">=</span><span class="s1"> </span><span class="s7">false</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> messageBox </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'message-box'</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span>messageBox</span><span class="s8">.</span><span class="s4">innerHTML </span><span class="s8">=</span><span class="s4"> </span><span class="s1">`&lt;div class="p-3 my-2 rounded-lg text-sm text-white </span><span class="s8">${</span><span class="s4">isError </span><span class="s8">?</span><span class="s4"> </span><span class="s1">'bg-red-500'</span><span class="s4"> </span><span class="s8">:</span><span class="s4"> </span><span class="s1">'bg-green-500'</span><span class="s8">}</span><span class="s1">"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">${</span><span class="s4">text</span><span class="s8">}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>setTimeout</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>messageBox</span><span class="s8">.</span><span class="s1">innerHTML </span><span class="s8">=</span><span class="s1"> </span><span class="s9">''</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">},</span><span class="s1"> </span><span class="s12">5000</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">async</span><span class="s1"> </span><span class="s7">function</span><span class="s1"> renderSessionList</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'session-list-view'</span><span class="s8">).</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(</span><span class="s9">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'game-view'</span><span class="s8">).</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s9">'hidden'</span><span class="s8">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> sessionsListContainer </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'sessions-list'</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span>sessionsListContainer</span><span class="s8">.</span><span class="s4">innerHTML </span><span class="s8">=</span><span class="s4"> </span><span class="s1">`&lt;div class="text-center text-gray-500"&gt;Caricamento sessioni...&lt;/div&gt;`</span><span class="s8">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">try</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Ora recuperiamo le sessioni dalla cartella pubblica per la condivisione</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> sessionsRef </span><span class="s8">=</span><span class="s1"> collection</span><span class="s8">(</span><span class="s1">db</span><span class="s8">,</span><span class="s1"> </span><span class="s9">`artifacts/</span><span class="s8">${</span><span class="s1">appId</span><span class="s8">}</span><span class="s9">/public/data/bocce-sessions`</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> querySnapshot </span><span class="s8">=</span><span class="s1"> </span><span class="s7">await</span><span class="s1"> getDocs</span><span class="s8">(</span><span class="s1">sessionsRef</span><span class="s8">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">querySnapshot</span><span class="s8">.</span><span class="s1">empty</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span>sessionsListContainer</span><span class="s8">.</span><span class="s4">innerHTML </span><span class="s8">=</span><span class="s4"> </span><span class="s1">`&lt;div class="text-center text-gray-500"&gt;Nessuna sessione trovata. Avviane una nuova!&lt;/div&gt;`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">return</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>sessionsListContainer</span><span class="s8">.</span><span class="s1">innerHTML </span><span class="s8">=</span><span class="s1"> </span><span class="s9">''</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>querySnapshot</span><span class="s8">.</span><span class="s1">forEach</span><span class="s8">((</span><span class="s1">doc</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> sessionData </span><span class="s8">=</span><span class="s1"> doc</span><span class="s8">.</span><span class="s1">data</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> playersNames </span><span class="s8">=</span><span class="s1"> sessionData</span><span class="s8">.</span><span class="s1">players</span><span class="s8">.</span><span class="s1">map</span><span class="s8">(</span><span class="s1">p </span><span class="s8">=&gt;</span><span class="s1"> p</span><span class="s8">.</span><span class="s1">name</span><span class="s8">).</span><span class="s1">join</span><span class="s8">(</span><span class="s9">', '</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> sessionItem </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">createElement</span><span class="s8">(</span><span class="s9">'div'</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span>sessionItem</span><span class="s8">.</span><span class="s4">className </span><span class="s8">=</span><span class="s4"> </span><span class="s1">'bg-white p-6 rounded-xl shadow-lg border border-gray-200 cursor-pointer hover:shadow-xl transform hover:-translate-y-1 transition-all duration-200'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>sessionItem</span><span class="s8">.</span><span class="s1">innerHTML </span><span class="s8">=</span><span class="s1"> </span><span class="s9">`</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;p class="font-bold text-lg text-blue-800"&gt;</span><span class="s8">${</span><span class="s4">sessionData</span><span class="s8">.</span><span class="s4">date</span><span class="s8">}</span><span class="s1"> - </span><span class="s8">${</span><span class="s4">sessionData</span><span class="s8">.</span><span class="s4">gameType</span><span class="s8">}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;p class="text-sm text-gray-600"&gt;Giocatori: </span><span class="s8">${</span><span class="s4">playersNames</span><span class="s8">}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>sessionItem</span><span class="s8">.</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'click'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>enterGameView</span><span class="s8">(</span><span class="s1">doc</span><span class="s8">.</span><span class="s1">id</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>sessionsListContainer</span><span class="s8">.</span><span class="s1">appendChild</span><span class="s8">(</span><span class="s1">sessionItem</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">});</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">catch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s8">.</span><span class="s4">error</span><span class="s8">(</span><span class="s1">"Errore nel recupero delle sessioni:"</span><span class="s8">,</span><span class="s4"> e</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>sessionsListContainer</span><span class="s8">.</span><span class="s4">innerHTML </span><span class="s8">=</span><span class="s4"> </span><span class="s1">`&lt;div class="text-center text-red-600"&gt;Errore nel caricamento delle sessioni.&lt;/div&gt;`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">async</span><span class="s1"> </span><span class="s7">function</span><span class="s1"> enterGameView</span><span class="s8">(</span><span class="s1">sessionId</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">unsubscribeFromGame</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>unsubscribeFromGame</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'session-list-view'</span><span class="s8">).</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s9">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'game-view'</span><span class="s8">).</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(</span><span class="s9">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentSessionId </span><span class="s8">=</span><span class="s1"> sessionId</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>startRealtimeGameListener</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">async</span><span class="s1"> </span><span class="s7">function</span><span class="s1"> handleSessionFormSubmit</span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>e</span><span class="s8">.</span><span class="s1">preventDefault</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> sessionDate </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'session-date'</span><span class="s8">).</span><span class="s1">value</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> gameType </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'game-type'</span><span class="s8">).</span><span class="s1">value</span><span class="s8">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> players </span><span class="s8">=</span><span class="s1"> </span><span class="s8">[];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">let</span><span class="s1"> playerCount </span><span class="s8">=</span><span class="s1"> </span><span class="s12">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">switch</span><span class="s8">(</span><span class="s1">gameType</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">case</span><span class="s1"> </span><span class="s9">'1vs1'</span><span class="s8">:</span><span class="s1"> playerCount </span><span class="s8">=</span><span class="s1"> </span><span class="s12">2</span><span class="s8">;</span><span class="s1"> </span><span class="s7">break</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">case</span><span class="s1"> </span><span class="s9">'2vs2'</span><span class="s8">:</span><span class="s1"> playerCount </span><span class="s8">=</span><span class="s1"> </span><span class="s12">4</span><span class="s8">;</span><span class="s1"> </span><span class="s7">break</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">case</span><span class="s1"> </span><span class="s9">'3vs3'</span><span class="s8">:</span><span class="s1"> playerCount </span><span class="s8">=</span><span class="s1"> </span><span class="s12">6</span><span class="s8">;</span><span class="s1"> </span><span class="s7">break</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">for</span><span class="s1"> </span><span class="s8">(</span><span class="s7">let</span><span class="s1"> i </span><span class="s8">=</span><span class="s1"> </span><span class="s12">1</span><span class="s8">;</span><span class="s1"> i </span><span class="s8">&lt;=</span><span class="s1"> playerCount</span><span class="s8">;</span><span class="s1"> i</span><span class="s8">++)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> playerName </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">`player-name-</span><span class="s8">${</span><span class="s1">i</span><span class="s8">}</span><span class="s9">`</span><span class="s8">).</span><span class="s1">value</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> playerTeam </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">`player-team-</span><span class="s8">${</span><span class="s1">i</span><span class="s8">}</span><span class="s9">`</span><span class="s8">).</span><span class="s1">value</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">playerName</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>players</span><span class="s8">.</span><span class="s1">push</span><span class="s8">({</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> playerName</span><span class="s8">,</span><span class="s1"> specialty</span><span class="s8">:</span><span class="s1"> gameType</span><span class="s8">,</span><span class="s1"> team</span><span class="s8">:</span><span class="s1"> playerTeam</span><span class="s8">,</span><span class="s1"> plays</span><span class="s8">:</span><span class="s1"> </span><span class="s8">[]</span><span class="s1"> </span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">players</span><span class="s8">.</span><span class="s1">length </span><span class="s8">!==</span><span class="s1"> playerCount</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>showMessage</span><span class="s8">(</span><span class="s1">`Devi inserire </span><span class="s8">${</span><span class="s4">playerCount</span><span class="s8">}</span><span class="s1"> atleti per il tipo di partita selezionato.`</span><span class="s8">,</span><span class="s4"> </span><span class="s7">true</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">return</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">try</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Ora salviamo le nuove sessioni nella cartella pubblica</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> sessionsRef </span><span class="s8">=</span><span class="s1"> collection</span><span class="s8">(</span><span class="s1">db</span><span class="s8">,</span><span class="s1"> </span><span class="s9">`artifacts/</span><span class="s8">${</span><span class="s1">appId</span><span class="s8">}</span><span class="s9">/public/data/bocce-sessions`</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> newSession </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>date</span><span class="s8">:</span><span class="s1"> sessionDate</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>gameType</span><span class="s8">:</span><span class="s1"> gameType</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>players</span><span class="s8">:</span><span class="s1"> players</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>currentPhase</span><span class="s8">:</span><span class="s1"> </span><span class="s12">1</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>ballsInPhase</span><span class="s8">:</span><span class="s1"> </span><span class="s12">0</span><span class="s8">,</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>currentFieldSector</span><span class="s8">:</span><span class="s4"> </span><span class="s7">null</span><span class="s8">,</span><span class="s4"> </span><span class="s1">// Aggiunto per tracciare il quarto di campo</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>createdAt</span><span class="s8">:</span><span class="s1"> </span><span class="s7">new</span><span class="s1"> </span><span class="s11">Date</span><span class="s8">()</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">await</span><span class="s1"> addDoc</span><span class="s8">(</span><span class="s1">sessionsRef</span><span class="s8">,</span><span class="s1"> newSession</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>showMessage</span><span class="s8">(</span><span class="s1">'Sessione creata con successo!'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'session-form-modal'</span><span class="s8">).</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s9">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>renderSessionList</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">catch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s8">.</span><span class="s4">error</span><span class="s8">(</span><span class="s1">"Errore nell'aggiunta del documento:"</span><span class="s8">,</span><span class="s4"> e</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>showMessage</span><span class="s8">(</span><span class="s1">'Errore nella creazione della sessione.'</span><span class="s8">,</span><span class="s4"> </span><span class="s7">true</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">function</span><span class="s1"> startRealtimeGameListener</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Aggiorna il listener per la cartella pubblica</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> sessionDocRef </span><span class="s8">=</span><span class="s1"> doc</span><span class="s8">(</span><span class="s1">db</span><span class="s8">,</span><span class="s1"> </span><span class="s9">`artifacts/</span><span class="s8">${</span><span class="s1">appId</span><span class="s8">}</span><span class="s9">/public/data/bocce-sessions`</span><span class="s8">,</span><span class="s1"> currentSessionId</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>unsubscribeFromGame </span><span class="s8">=</span><span class="s1"> onSnapshot</span><span class="s8">(</span><span class="s1">sessionDocRef</span><span class="s8">,</span><span class="s1"> </span><span class="s8">(</span><span class="s1">docSnap</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">docSnap</span><span class="s8">.</span><span class="s1">exists</span><span class="s8">())</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>latestSessionData </span><span class="s8">=</span><span class="s1"> docSnap</span><span class="s8">.</span><span class="s1">data</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>renderGameState</span><span class="s8">(</span><span class="s1">latestSessionData</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">else</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span>showMessage</span><span class="s8">(</span><span class="s1">"Sessione non trovata. Tornando alla lista sessioni."</span><span class="s8">,</span><span class="s4"> </span><span class="s7">true</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'back-to-sessions-btn'</span><span class="s8">).</span><span class="s1">click</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">},</span><span class="s1"> </span><span class="s8">(</span><span class="s1">error</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>console</span><span class="s8">.</span><span class="s1">error</span><span class="s8">(</span><span class="s9">"Errore nel listener:"</span><span class="s8">,</span><span class="s1"> error</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>showMessage</span><span class="s8">(</span><span class="s1">"Errore nella sincronizzazione della partita."</span><span class="s8">,</span><span class="s4"> </span><span class="s7">true</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">function</span><span class="s1"> renderGameState</span><span class="s8">(</span><span class="s1">sessionData</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Mostra lo stato della partita</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'game-phase'</span><span class="s8">).</span><span class="s1">innerText </span><span class="s8">=</span><span class="s1"> </span><span class="s9">`Fase: </span><span class="s8">${</span><span class="s1">sessionData</span><span class="s8">.</span><span class="s1">currentPhase</span><span class="s8">}</span><span class="s9">`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'game-type-display'</span><span class="s8">).</span><span class="s1">innerText </span><span class="s8">=</span><span class="s1"> </span><span class="s9">`Tipo di Partita: </span><span class="s8">${</span><span class="s1">sessionData</span><span class="s8">.</span><span class="s1">gameType</span><span class="s8">}</span><span class="s9">`</span><span class="s8">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Controlla se una fase è completa</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> ballsPerPhase </span><span class="s8">=</span><span class="s1"> sessionData</span><span class="s8">.</span><span class="s1">gameType </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'3vs3'</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s12">6</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s12">8</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> isPhaseComplete </span><span class="s8">=</span><span class="s1"> sessionData</span><span class="s8">.</span><span class="s1">ballsInPhase </span><span class="s8">&gt;=</span><span class="s1"> ballsPerPhase</span><span class="s8">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">isPhaseComplete</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'end-phase-message'</span><span class="s8">).</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(</span><span class="s9">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'start-next-phase-btn'</span><span class="s8">).</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(</span><span class="s9">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'cancel-phase-btn'</span><span class="s8">).</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s9">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">else</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'end-phase-message'</span><span class="s8">).</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s9">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'start-next-phase-btn'</span><span class="s8">).</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s9">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'cancel-phase-btn'</span><span class="s8">).</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(</span><span class="s9">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>renderPlayers</span><span class="s8">(</span><span class="s1">sessionData</span><span class="s8">.</span><span class="s1">players</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">async</span><span class="s1"> </span><span class="s7">function</span><span class="s1"> startNextPhase</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">try</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Aggiorna la fase nella cartella pubblica</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> sessionDocRef </span><span class="s8">=</span><span class="s1"> doc</span><span class="s8">(</span><span class="s1">db</span><span class="s8">,</span><span class="s1"> </span><span class="s9">`artifacts/</span><span class="s8">${</span><span class="s1">appId</span><span class="s8">}</span><span class="s9">/public/data/bocce-sessions`</span><span class="s8">,</span><span class="s1"> currentSessionId</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> docSnap </span><span class="s8">=</span><span class="s1"> </span><span class="s7">await</span><span class="s1"> getDoc</span><span class="s8">(</span><span class="s1">sessionDocRef</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">docSnap</span><span class="s8">.</span><span class="s1">exists</span><span class="s8">())</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> sessionData </span><span class="s8">=</span><span class="s1"> docSnap</span><span class="s8">.</span><span class="s1">data</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">await</span><span class="s1"> updateDoc</span><span class="s8">(</span><span class="s1">sessionDocRef</span><span class="s8">,</span><span class="s1"> </span><span class="s8">{</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>currentPhase</span><span class="s8">:</span><span class="s1"> sessionData</span><span class="s8">.</span><span class="s1">currentPhase </span><span class="s8">+</span><span class="s1"> </span><span class="s12">1</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>ballsInPhase</span><span class="s8">:</span><span class="s1"> </span><span class="s12">0</span><span class="s8">,</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                        </span>currentFieldSector</span><span class="s8">:</span><span class="s4"> </span><span class="s7">null</span><span class="s4"> </span><span class="s1">// Resetta il quarto di campo all'inizio di una nuova fase</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>showMessage</span><span class="s8">(</span><span class="s9">"Fase successiva avviata!"</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">catch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s8">.</span><span class="s4">error</span><span class="s8">(</span><span class="s1">"Errore nell'aggiornamento della fase:"</span><span class="s8">,</span><span class="s4"> e</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>showMessage</span><span class="s8">(</span><span class="s1">"Errore nell'avvio della prossima fase."</span><span class="s8">,</span><span class="s4"> </span><span class="s7">true</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">async</span><span class="s1"> </span><span class="s7">function</span><span class="s1"> cancelPhase</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">try</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Annulla la fase nella cartella pubblica</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> sessionDocRef </span><span class="s8">=</span><span class="s1"> doc</span><span class="s8">(</span><span class="s1">db</span><span class="s8">,</span><span class="s1"> </span><span class="s9">`artifacts/</span><span class="s8">${</span><span class="s1">appId</span><span class="s8">}</span><span class="s9">/public/data/bocce-sessions`</span><span class="s8">,</span><span class="s1"> currentSessionId</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> docSnap </span><span class="s8">=</span><span class="s1"> </span><span class="s7">await</span><span class="s1"> getDoc</span><span class="s8">(</span><span class="s1">sessionDocRef</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">docSnap</span><span class="s8">.</span><span class="s1">exists</span><span class="s8">())</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> sessionData </span><span class="s8">=</span><span class="s1"> docSnap</span><span class="s8">.</span><span class="s1">data</span><span class="s8">();</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> updatedPlayers </span><span class="s8">=</span><span class="s1"> sessionData</span><span class="s8">.</span><span class="s1">players</span><span class="s8">.</span><span class="s1">map</span><span class="s8">(</span><span class="s1">player </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">return</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">...</span><span class="s1">player</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span>plays</span><span class="s8">:</span><span class="s1"> player</span><span class="s8">.</span><span class="s1">plays</span><span class="s8">.</span><span class="s1">filter</span><span class="s8">(</span><span class="s1">play </span><span class="s8">=&gt;</span><span class="s1"> play</span><span class="s8">.</span><span class="s1">phase </span><span class="s8">!==</span><span class="s1"> sessionData</span><span class="s8">.</span><span class="s1">currentPhase</span><span class="s8">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">});</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> updates </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>players</span><span class="s8">:</span><span class="s1"> updatedPlayers</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>ballsInPhase</span><span class="s8">:</span><span class="s1"> </span><span class="s12">0</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>currentFieldSector</span><span class="s8">:</span><span class="s1"> </span><span class="s7">null</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">};</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">await</span><span class="s1"> updateDoc</span><span class="s8">(</span><span class="s1">sessionDocRef</span><span class="s8">,</span><span class="s1"> updates</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span>showMessage</span><span class="s8">(</span><span class="s1">"Fase annullata con successo. I dati sono stati ripristinati."</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">catch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s8">.</span><span class="s4">error</span><span class="s8">(</span><span class="s1">"Errore nell'annullamento della fase:"</span><span class="s8">,</span><span class="s4"> e</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>showMessage</span><span class="s8">(</span><span class="s1">"Errore nell'annullamento della fase."</span><span class="s8">,</span><span class="s4"> </span><span class="s7">true</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">function</span><span class="s1"> getPlayerStats</span><span class="s8">(</span><span class="s1">player</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> stats </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>accosto</span><span class="s8">:</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> success</span><span class="s8">:</span><span class="s1"> </span><span class="s12">0</span><span class="s8">,</span><span class="s1"> total</span><span class="s8">:</span><span class="s1"> </span><span class="s12">0</span><span class="s8">,</span><span class="s1"> distance</span><span class="s8">:</span><span class="s1"> </span><span class="s12">0</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>raffaBoccia</span><span class="s8">:</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> success</span><span class="s8">:</span><span class="s1"> </span><span class="s12">0</span><span class="s8">,</span><span class="s1"> total</span><span class="s8">:</span><span class="s1"> </span><span class="s12">0</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>raffaPallino</span><span class="s8">:</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> success</span><span class="s8">:</span><span class="s1"> </span><span class="s12">0</span><span class="s8">,</span><span class="s1"> total</span><span class="s8">:</span><span class="s1"> </span><span class="s12">0</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>voloBoccia</span><span class="s8">:</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> success</span><span class="s8">:</span><span class="s1"> </span><span class="s12">0</span><span class="s8">,</span><span class="s1"> total</span><span class="s8">:</span><span class="s1"> </span><span class="s12">0</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>player</span><span class="s8">.</span><span class="s1">plays</span><span class="s8">.</span><span class="s1">forEach</span><span class="s8">(</span><span class="s1">play </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">switch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">play</span><span class="s8">.</span><span class="s1">type</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">case</span><span class="s1"> </span><span class="s9">'accosto'</span><span class="s8">:</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>stats</span><span class="s8">.</span><span class="s1">accosto</span><span class="s8">.</span><span class="s1">total</span><span class="s8">++;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>stats</span><span class="s8">.</span><span class="s1">accosto</span><span class="s8">.</span><span class="s1">distance </span><span class="s8">+=</span><span class="s1"> play</span><span class="s8">.</span><span class="s1">distance</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">break</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">case</span><span class="s1"> </span><span class="s9">'raffaBoccia'</span><span class="s8">:</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>stats</span><span class="s8">.</span><span class="s1">raffaBoccia</span><span class="s8">.</span><span class="s1">total</span><span class="s8">++;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">play</span><span class="s8">.</span><span class="s1">result </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'hit'</span><span class="s8">)</span><span class="s1"> stats</span><span class="s8">.</span><span class="s1">raffaBoccia</span><span class="s8">.</span><span class="s1">success</span><span class="s8">++;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">break</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">case</span><span class="s1"> </span><span class="s9">'raffaPallino'</span><span class="s8">:</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>stats</span><span class="s8">.</span><span class="s1">raffaPallino</span><span class="s8">.</span><span class="s1">total</span><span class="s8">++;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">play</span><span class="s8">.</span><span class="s1">result </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'hit'</span><span class="s8">)</span><span class="s1"> stats</span><span class="s8">.</span><span class="s1">raffaPallino</span><span class="s8">.</span><span class="s1">success</span><span class="s8">++;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">break</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">case</span><span class="s1"> </span><span class="s9">'voloBoccia'</span><span class="s8">:</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>stats</span><span class="s8">.</span><span class="s1">voloBoccia</span><span class="s8">.</span><span class="s1">total</span><span class="s8">++;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">play</span><span class="s8">.</span><span class="s1">result </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'hit'</span><span class="s8">)</span><span class="s1"> stats</span><span class="s8">.</span><span class="s1">voloBoccia</span><span class="s8">.</span><span class="s1">success</span><span class="s8">++;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">break</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">return</span><span class="s1"> stats</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">function</span><span class="s1"> renderPlayers</span><span class="s8">(</span><span class="s1">players</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> playersContainer </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'players-container'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>playersContainer</span><span class="s8">.</span><span class="s1">innerHTML </span><span class="s8">=</span><span class="s1"> </span><span class="s9">''</span><span class="s8">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>players</span><span class="s8">.</span><span class="s1">forEach</span><span class="s8">((</span><span class="s1">player</span><span class="s8">,</span><span class="s1"> playerIndex</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> stats </span><span class="s8">=</span><span class="s1"> getPlayerStats</span><span class="s8">(</span><span class="s1">player</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> playerCard </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">createElement</span><span class="s8">(</span><span class="s9">'div'</span><span class="s8">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">let</span><span class="s1"> teamColorClass </span><span class="s8">=</span><span class="s1"> </span><span class="s9">''</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">let</span><span class="s1"> teamTextColorClass </span><span class="s8">=</span><span class="s1"> </span><span class="s9">''</span><span class="s8">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">player</span><span class="s8">.</span><span class="s1">team </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'Squadra 1'</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>teamColorClass </span><span class="s8">=</span><span class="s1"> </span><span class="s9">'border-blue-500'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>teamTextColorClass </span><span class="s8">=</span><span class="s1"> </span><span class="s9">'text-blue-800'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">else</span><span class="s1"> </span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">player</span><span class="s8">.</span><span class="s1">team </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'Squadra 2'</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>teamColorClass </span><span class="s8">=</span><span class="s1"> </span><span class="s9">'border-red-500'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>teamTextColorClass </span><span class="s8">=</span><span class="s1"> </span><span class="s9">'text-red-800'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>playerCard</span><span class="s8">.</span><span class="s4">className </span><span class="s8">=</span><span class="s4"> </span><span class="s1">`player-card bg-white p-6 rounded-xl shadow-lg border-4 </span><span class="s8">${</span><span class="s4">teamColorClass</span><span class="s8">}</span><span class="s1"> cursor-pointer hover:shadow-xl transform hover:-translate-y-1 transition-all duration-200`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>playerCard</span><span class="s8">.</span><span class="s1">setAttribute</span><span class="s8">(</span><span class="s9">'data-player-index'</span><span class="s8">,</span><span class="s1"> playerIndex</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>playerCard</span><span class="s8">.</span><span class="s1">innerHTML </span><span class="s8">=</span><span class="s1"> </span><span class="s9">`</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;h4 class="text-lg font-bold mb-1 text-center </span><span class="s8">${</span><span class="s4">teamTextColorClass</span><span class="s8">}</span><span class="s1">"&gt;</span><span class="s8">${</span><span class="s4">player</span><span class="s8">.</span><span class="s4">name</span><span class="s8">}</span><span class="s1"> &lt;span class="text-sm font-normal text-gray-500"&gt;- </span><span class="s8">${</span><span class="s4">player</span><span class="s8">.</span><span class="s4">team</span><span class="s8">}</span><span class="s1">&lt;/span&gt;&lt;/h4&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="mt-4 p-4 bg-gray-100 rounded-lg"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;h5 class="text-md font-bold mb-2 text-center"&gt;Statistiche Giocatore&lt;/h5&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;ul class="text-sm space-y-1"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;li&gt;&lt;strong&gt;Accosto:&lt;/strong&gt; </span><span class="s8">${</span><span class="s4">stats</span><span class="s8">.</span><span class="s4">accosto</span><span class="s8">.</span><span class="s4">total</span><span class="s8">}</span><span class="s1"> giocate, </span><span class="s8">${</span><span class="s4">stats</span><span class="s8">.</span><span class="s4">accosto</span><span class="s8">.</span><span class="s4">total </span><span class="s8">&gt;</span><span class="s4"> </span><span class="s12">0</span><span class="s4"> </span><span class="s8">?</span><span class="s4"> </span><span class="s8">(</span><span class="s4">stats</span><span class="s8">.</span><span class="s4">accosto</span><span class="s8">.</span><span class="s4">distance </span><span class="s8">/</span><span class="s4"> stats</span><span class="s8">.</span><span class="s4">accosto</span><span class="s8">.</span><span class="s4">total</span><span class="s8">).</span><span class="s4">toFixed</span><span class="s8">(</span><span class="s12">2</span><span class="s8">)</span><span class="s4"> </span><span class="s8">:</span><span class="s4"> </span><span class="s1">'0.00'</span><span class="s8">}</span><span class="s1"> cm di media&lt;/li&gt;</span></p>
<p class="p4"><span class="s9"><span class="Apple-converted-space">                            </span>&lt;li&gt;&lt;strong&gt;Raffa Boccia:&lt;/strong&gt; </span><span class="s8">${</span><span class="s1">stats</span><span class="s8">.</span><span class="s1">raffaBoccia</span><span class="s8">.</span><span class="s1">success</span><span class="s8">}</span><span class="s9">/</span><span class="s8">${</span><span class="s1">stats</span><span class="s8">.</span><span class="s1">raffaBoccia</span><span class="s8">.</span><span class="s1">total</span><span class="s8">}</span><span class="s9"> (</span><span class="s8">${</span><span class="s1">stats</span><span class="s8">.</span><span class="s1">raffaBoccia</span><span class="s8">.</span><span class="s1">total </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s12">0</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s8">(</span><span class="s1">stats</span><span class="s8">.</span><span class="s1">raffaBoccia</span><span class="s8">.</span><span class="s1">success </span><span class="s8">/</span><span class="s1"> stats</span><span class="s8">.</span><span class="s1">raffaBoccia</span><span class="s8">.</span><span class="s1">total </span><span class="s8">*</span><span class="s1"> </span><span class="s12">100</span><span class="s8">).</span><span class="s1">toFixed</span><span class="s8">(</span><span class="s12">2</span><span class="s8">)</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s9">'0.00'</span><span class="s8">}</span><span class="s9">%)&lt;/li&gt;</span></p>
<p class="p4"><span class="s9"><span class="Apple-converted-space">                            </span>&lt;li&gt;&lt;strong&gt;Raffa Pallino:&lt;/strong&gt; </span><span class="s8">${</span><span class="s1">stats</span><span class="s8">.</span><span class="s1">raffaPallino</span><span class="s8">.</span><span class="s1">success</span><span class="s8">}</span><span class="s9">/</span><span class="s8">${</span><span class="s1">stats</span><span class="s8">.</span><span class="s1">raffaPallino</span><span class="s8">.</span><span class="s1">total</span><span class="s8">}</span><span class="s9"> (</span><span class="s8">${</span><span class="s1">stats</span><span class="s8">.</span><span class="s1">raffaPallino</span><span class="s8">.</span><span class="s1">total </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s12">0</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s8">(</span><span class="s1">stats</span><span class="s8">.</span><span class="s1">raffaPallino</span><span class="s8">.</span><span class="s1">success </span><span class="s8">/</span><span class="s1"> stats</span><span class="s8">.</span><span class="s1">raffaPallino</span><span class="s8">.</span><span class="s1">total </span><span class="s8">*</span><span class="s1"> </span><span class="s12">100</span><span class="s8">).</span><span class="s1">toFixed</span><span class="s8">(</span><span class="s12">2</span><span class="s8">)</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s9">'0.00'</span><span class="s8">}</span><span class="s9">%)&lt;/li&gt;</span></p>
<p class="p4"><span class="s9"><span class="Apple-converted-space">                            </span>&lt;li&gt;&lt;strong&gt;Volo Boccia:&lt;/strong&gt; </span><span class="s8">${</span><span class="s1">stats</span><span class="s8">.</span><span class="s1">voloBoccia</span><span class="s8">.</span><span class="s1">success</span><span class="s8">}</span><span class="s9">/</span><span class="s8">${</span><span class="s1">stats</span><span class="s8">.</span><span class="s1">voloBoccia</span><span class="s8">.</span><span class="s1">total</span><span class="s8">}</span><span class="s9"> (</span><span class="s8">${</span><span class="s1">stats</span><span class="s8">.</span><span class="s1">voloBoccia</span><span class="s8">.</span><span class="s1">total </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s12">0</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s8">(</span><span class="s1">stats</span><span class="s8">.</span><span class="s1">voloBoccia</span><span class="s8">.</span><span class="s1">success </span><span class="s8">/</span><span class="s1"> stats</span><span class="s8">.</span><span class="s1">voloBoccia</span><span class="s8">.</span><span class="s1">total </span><span class="s8">*</span><span class="s1"> </span><span class="s12">100</span><span class="s8">).</span><span class="s1">toFixed</span><span class="s8">(</span><span class="s12">2</span><span class="s8">)</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s9">'0.00'</span><span class="s8">}</span><span class="s9">%)&lt;/li&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/ul&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>playersContainer</span><span class="s8">.</span><span class="s1">appendChild</span><span class="s8">(</span><span class="s1">playerCard</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>playerCard</span><span class="s8">.</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'click'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> showPlayModal</span><span class="s8">(</span><span class="s1">player</span><span class="s8">,</span><span class="s1"> playerIndex</span><span class="s8">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">function</span><span class="s1"> showPlayModal</span><span class="s8">(</span><span class="s1">player</span><span class="s8">,</span><span class="s1"> playerIndex</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'play-modal-title'</span><span class="s8">).</span><span class="s1">innerText </span><span class="s8">=</span><span class="s1"> </span><span class="s9">`Registra giocata per </span><span class="s8">${</span><span class="s1">player</span><span class="s8">.</span><span class="s1">name</span><span class="s8">}</span><span class="s9">`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'play-form-modal'</span><span class="s8">).</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(</span><span class="s9">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'play-form'</span><span class="s8">).</span><span class="s1">setAttribute</span><span class="s8">(</span><span class="s9">'data-player-index'</span><span class="s8">,</span><span class="s1"> playerIndex</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'play-type'</span><span class="s8">).</span><span class="s1">value </span><span class="s8">=</span><span class="s1"> </span><span class="s9">""</span><span class="s8">;</span><span class="s1"> </span><span class="s13">// Reset play type</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>updatePlayForm</span><span class="s8">();</span><span class="s4"> </span><span class="s1">// Resetta il form e la logica del campo</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">async</span><span class="s1"> </span><span class="s7">function</span><span class="s1"> handlePlayFormSubmit</span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>e</span><span class="s8">.</span><span class="s1">preventDefault</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> form </span><span class="s8">=</span><span class="s1"> e</span><span class="s8">.</span><span class="s1">target</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> playerIndex </span><span class="s8">=</span><span class="s1"> form</span><span class="s8">.</span><span class="s1">getAttribute</span><span class="s8">(</span><span class="s9">'data-player-index'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> playType </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'play-type'</span><span class="s8">).</span><span class="s1">value</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> fieldSector </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'play-field-sector'</span><span class="s8">).</span><span class="s1">value</span><span class="s8">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">playType </span><span class="s8">||</span><span class="s1"> </span><span class="s8">!</span><span class="s1">fieldSector</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>showMessage</span><span class="s8">(</span><span class="s1">"Tipo di giocata e quarto di campo sono obbligatori."</span><span class="s8">,</span><span class="s4"> </span><span class="s7">true</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">return</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> newPlay </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>type</span><span class="s8">:</span><span class="s1"> playType</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>sector</span><span class="s8">:</span><span class="s1"> fieldSector</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>timestamp</span><span class="s8">:</span><span class="s1"> </span><span class="s7">new</span><span class="s1"> </span><span class="s11">Date</span><span class="s8">().</span><span class="s1">toISOString</span><span class="s8">(),</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>phase</span><span class="s8">:</span><span class="s1"> latestSessionData</span><span class="s8">.</span><span class="s1">currentPhase </span><span class="s13">// Salva il numero della fase con la giocata</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">};</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">playType </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'accosto'</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>newPlay</span><span class="s8">.</span><span class="s1">distance </span><span class="s8">=</span><span class="s1"> parseFloat</span><span class="s8">(</span><span class="s1">form</span><span class="s8">.</span><span class="s1">querySelector</span><span class="s8">(</span><span class="s9">'input[name="distance"]'</span><span class="s8">).</span><span class="s1">value</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">else</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>newPlay</span><span class="s8">.</span><span class="s1">direction </span><span class="s8">=</span><span class="s1"> form</span><span class="s8">.</span><span class="s1">querySelector</span><span class="s8">(</span><span class="s9">'select[name="direction"]'</span><span class="s8">).</span><span class="s1">value</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>newPlay</span><span class="s8">.</span><span class="s1">result </span><span class="s8">=</span><span class="s1"> form</span><span class="s8">.</span><span class="s1">querySelector</span><span class="s8">(</span><span class="s9">'select[name="result"]'</span><span class="s8">).</span><span class="s1">value</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">try</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Registra la giocata nella cartella pubblica</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> sessionDocRef </span><span class="s8">=</span><span class="s1"> doc</span><span class="s8">(</span><span class="s1">db</span><span class="s8">,</span><span class="s1"> </span><span class="s9">`artifacts/</span><span class="s8">${</span><span class="s1">appId</span><span class="s8">}</span><span class="s9">/public/data/bocce-sessions`</span><span class="s8">,</span><span class="s1"> currentSessionId</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> docSnap </span><span class="s8">=</span><span class="s1"> </span><span class="s7">await</span><span class="s1"> getDoc</span><span class="s8">(</span><span class="s1">sessionDocRef</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">docSnap</span><span class="s8">.</span><span class="s1">exists</span><span class="s8">())</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> sessionData </span><span class="s8">=</span><span class="s1"> docSnap</span><span class="s8">.</span><span class="s1">data</span><span class="s8">();</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>sessionData</span><span class="s8">.</span><span class="s1">players</span><span class="s8">[</span><span class="s1">playerIndex</span><span class="s8">].</span><span class="s1">plays</span><span class="s8">.</span><span class="s1">push</span><span class="s8">(</span><span class="s1">newPlay</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>sessionData</span><span class="s8">.</span><span class="s1">ballsInPhase</span><span class="s8">++;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> updates </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>players</span><span class="s8">:</span><span class="s1"> sessionData</span><span class="s8">.</span><span class="s1">players</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>ballsInPhase</span><span class="s8">:</span><span class="s1"> sessionData</span><span class="s8">.</span><span class="s1">ballsInPhase</span><span class="s8">,</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s1">// Aggiorna sempre il quarto di campo con il valore selezionato dall'utente</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>currentFieldSector</span><span class="s8">:</span><span class="s1"> newPlay</span><span class="s8">.</span><span class="s1">sector</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">};</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">await</span><span class="s1"> updateDoc</span><span class="s8">(</span><span class="s1">sessionDocRef</span><span class="s8">,</span><span class="s1"> updates</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span>showMessage</span><span class="s8">(</span><span class="s1">"Giocata registrata con successo!"</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'play-form-modal'</span><span class="s8">).</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s9">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>form</span><span class="s8">.</span><span class="s1">reset</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">catch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s8">.</span><span class="s4">error</span><span class="s8">(</span><span class="s1">"Errore nell'aggiornamento del documento:"</span><span class="s8">,</span><span class="s4"> e</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>showMessage</span><span class="s8">(</span><span class="s1">"Errore nella registrazione della giocata."</span><span class="s8">,</span><span class="s4"> </span><span class="s7">true</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Funzione per esportare i dati in CSV</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">function</span><span class="s1"> exportToCSV</span><span class="s8">(</span><span class="s1">sessionData</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">sessionData </span><span class="s8">||</span><span class="s1"> </span><span class="s8">!</span><span class="s1">sessionData</span><span class="s8">.</span><span class="s1">players</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>showMessage</span><span class="s8">(</span><span class="s9">"Nessun dato da esportare."</span><span class="s8">,</span><span class="s1"> </span><span class="s7">true</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">return</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s7">let</span><span class="s4"> csvContent </span><span class="s8">=</span><span class="s4"> </span><span class="s1">"data:text/csv;charset=utf-8,"</span><span class="s8">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s4"> headers </span><span class="s8">=</span><span class="s4"> </span><span class="s8">[</span><span class="s1">"Giocatore"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"Specialità"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"Squadra"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"Tipo Giocata"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"Quarto Campo"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"Direzione"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"Esito"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"Distanza(cm)"</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>csvContent </span><span class="s8">+=</span><span class="s1"> headers</span><span class="s8">.</span><span class="s1">join</span><span class="s8">(</span><span class="s9">","</span><span class="s8">)</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s9">"\n"</span><span class="s8">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>sessionData</span><span class="s8">.</span><span class="s1">players</span><span class="s8">.</span><span class="s1">forEach</span><span class="s8">(</span><span class="s1">player </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>player</span><span class="s8">.</span><span class="s1">plays</span><span class="s8">.</span><span class="s1">forEach</span><span class="s8">(</span><span class="s1">play </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> row </span><span class="s8">=</span><span class="s1"> </span><span class="s8">[</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">`"</span><span class="s8">${</span><span class="s1">player</span><span class="s8">.</span><span class="s1">name</span><span class="s8">}</span><span class="s9">"`</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">`"</span><span class="s8">${</span><span class="s1">player</span><span class="s8">.</span><span class="s1">specialty</span><span class="s8">}</span><span class="s9">"`</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">`"</span><span class="s8">${</span><span class="s1">player</span><span class="s8">.</span><span class="s1">team</span><span class="s8">}</span><span class="s9">"`</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">`"</span><span class="s8">${</span><span class="s1">play</span><span class="s8">.</span><span class="s1">type</span><span class="s8">}</span><span class="s9">"`</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">`"</span><span class="s8">${</span><span class="s1">play</span><span class="s8">.</span><span class="s1">sector</span><span class="s8">}</span><span class="s9">"`</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">`"</span><span class="s8">${</span><span class="s1">play</span><span class="s8">.</span><span class="s1">direction </span><span class="s8">||</span><span class="s1"> </span><span class="s9">""</span><span class="s8">}</span><span class="s9">"`</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">`"</span><span class="s8">${</span><span class="s1">play</span><span class="s8">.</span><span class="s1">result </span><span class="s8">||</span><span class="s1"> </span><span class="s9">""</span><span class="s8">}</span><span class="s9">"`</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">`"</span><span class="s8">${</span><span class="s1">play</span><span class="s8">.</span><span class="s1">distance </span><span class="s8">||</span><span class="s1"> </span><span class="s9">""</span><span class="s8">}</span><span class="s9">"`</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>csvContent </span><span class="s8">+=</span><span class="s1"> row</span><span class="s8">.</span><span class="s1">join</span><span class="s8">(</span><span class="s9">","</span><span class="s8">)</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s9">"\n"</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> encodedUri </span><span class="s8">=</span><span class="s1"> encodeURI</span><span class="s8">(</span><span class="s1">csvContent</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> link </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">createElement</span><span class="s8">(</span><span class="s9">"a"</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>link</span><span class="s8">.</span><span class="s1">setAttribute</span><span class="s8">(</span><span class="s9">"href"</span><span class="s8">,</span><span class="s1"> encodedUri</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>link</span><span class="s8">.</span><span class="s1">setAttribute</span><span class="s8">(</span><span class="s9">"download"</span><span class="s8">,</span><span class="s1"> </span><span class="s9">`bocce_stats_</span><span class="s8">${</span><span class="s1">sessionData</span><span class="s8">.</span><span class="s1">date</span><span class="s8">}</span><span class="s9">.csv`</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">body</span><span class="s8">.</span><span class="s1">appendChild</span><span class="s8">(</span><span class="s1">link</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>link</span><span class="s8">.</span><span class="s1">click</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s8">.</span><span class="s1">body</span><span class="s8">.</span><span class="s1">removeChild</span><span class="s8">(</span><span class="s1">link</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span>showMessage</span><span class="s8">(</span><span class="s1">"Dati esportati in CSV!"</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Funzione per esportare le statistiche in PDF</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">function</span><span class="s1"> exportToPDF</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> playersContainer </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'players-container'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> jsPDF </span><span class="s8">}</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> window</span><span class="s8">.</span><span class="s1">jspdf</span><span class="s8">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">playersContainer </span><span class="s8">||</span><span class="s1"> playersContainer</span><span class="s8">.</span><span class="s1">children</span><span class="s8">.</span><span class="s1">length </span><span class="s8">===</span><span class="s1"> </span><span class="s12">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>showMessage</span><span class="s8">(</span><span class="s1">"Nessun dato da esportare in PDF."</span><span class="s8">,</span><span class="s4"> </span><span class="s7">true</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">return</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>html2canvas</span><span class="s8">(</span><span class="s1">playersContainer</span><span class="s8">).</span><span class="s1">then</span><span class="s8">(</span><span class="s1">canvas </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> imgData </span><span class="s8">=</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">toDataURL</span><span class="s8">(</span><span class="s9">'image/png'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> pdf </span><span class="s8">=</span><span class="s1"> </span><span class="s7">new</span><span class="s1"> jsPDF</span><span class="s8">(</span><span class="s9">'p'</span><span class="s8">,</span><span class="s1"> </span><span class="s9">'mm'</span><span class="s8">,</span><span class="s1"> </span><span class="s9">'a4'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> imgProps</span><span class="s8">=</span><span class="s1"> pdf</span><span class="s8">.</span><span class="s1">getImageProperties</span><span class="s8">(</span><span class="s1">imgData</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> pdfWidth </span><span class="s8">=</span><span class="s1"> pdf</span><span class="s8">.</span><span class="s1">internal</span><span class="s8">.</span><span class="s1">pageSize</span><span class="s8">.</span><span class="s1">getWidth</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> pdfHeight </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">imgProps</span><span class="s8">.</span><span class="s1">height </span><span class="s8">*</span><span class="s1"> pdfWidth</span><span class="s8">)</span><span class="s1"> </span><span class="s8">/</span><span class="s1"> imgProps</span><span class="s8">.</span><span class="s1">width</span><span class="s8">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>pdf</span><span class="s8">.</span><span class="s1">addImage</span><span class="s8">(</span><span class="s1">imgData</span><span class="s8">,</span><span class="s1"> </span><span class="s9">'PNG'</span><span class="s8">,</span><span class="s1"> </span><span class="s12">0</span><span class="s8">,</span><span class="s1"> </span><span class="s12">0</span><span class="s8">,</span><span class="s1"> pdfWidth</span><span class="s8">,</span><span class="s1"> pdfHeight</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>pdf</span><span class="s8">.</span><span class="s1">save</span><span class="s8">(</span><span class="s9">`report_bocce_</span><span class="s8">${</span><span class="s1">latestSessionData</span><span class="s8">.</span><span class="s1">date</span><span class="s8">}</span><span class="s9">.pdf`</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>showMessage</span><span class="s8">(</span><span class="s9">"Dati esportati in PDF!"</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">body</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-family:</span><span class="s1"> </span><span class="s9">'Inter'</span><span class="s8">,</span><span class="s1"> </span><span class="s5">sans-serif</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s1"> #f3f4f6</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background-image:</span><span class="s1"> </span><span class="s5">linear-gradient(to</span><span class="s1"> </span><span class="s5">bottom</span><span class="s1"> </span><span class="s5">right</span><span class="s8">,</span><span class="s1"> #e0e7ff</span><span class="s8">,</span><span class="s1"> #f3f4f6</span><span class="s5">)</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.modal</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">background-color:</span><span class="s4"> </span><span class="s5">rgba(</span><span class="s14">0</span><span class="s8">,</span><span class="s4"> </span><span class="s14">0</span><span class="s8">,</span><span class="s4"> </span><span class="s14">0</span><span class="s8">,</span><span class="s4"> </span><span class="s14">0.4</span><span class="s5">)</span><span class="s8">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">backdrop-filter:</span><span class="s4"> </span><span class="s5">blur(</span><span class="s14">4px</span><span class="s5">)</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s3">&lt;</span><span class="s6">body</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-gray-100 min-h-screen p-4 md:p-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">header</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-center mb-12"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">h1</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-5xl font-extrabold text-blue-900 mb-2 drop-shadow-lg"</span><span class="s3">&gt;</span><span class="s4">Bocce Performance Tracker</span><span class="s3">&lt;/</span><span class="s6">h1</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-gray-600 text-sm md:text-md"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"user-id-display"</span><span class="s3">&gt;&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">header</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">main</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"max-w-7xl mx-auto"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"message-box"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"fixed top-4 right-4 z-50"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- Modale per il Form Sessione --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"session-form-modal"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"modal fixed inset-0 flex items-center justify-center hidden z-50"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-white p-8 rounded-2xl shadow-2xl max-w-lg w-full transform transition-all duration-300"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex justify-between items-center mb-6"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-2xl font-bold text-gray-800"</span><span class="s3">&gt;</span><span class="s1">Dettagli Nuova Sessione</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"close-modal-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-gray-400 text-2xl hover:text-gray-600"</span><span class="s3">&gt;</span><span class="s4">&amp;times;</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">form</span><span class="s1"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"session-form"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"mb-4"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s4"> </span><span class="s2">for</span><span class="s3">=</span><span class="s1">"session-date"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"block text-gray-700 font-bold mb-2"</span><span class="s3">&gt;</span><span class="s4">Data Sessione:</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"date"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"session-date"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"</span><span class="s4"> </span><span class="s2">required</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"mb-4"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s4"> </span><span class="s2">for</span><span class="s3">=</span><span class="s1">"game-type"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"block text-gray-700 font-bold mb-2"</span><span class="s3">&gt;</span><span class="s4">Tipo di Partita:</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">select</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"game-type"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"</span><span class="s4"> </span><span class="s2">required</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">""</span><span class="s3">&gt;</span><span class="s1">Seleziona</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">"1vs1"</span><span class="s3">&gt;</span><span class="s1">1 vs 1</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">"2vs2"</span><span class="s3">&gt;</span><span class="s1">2 vs 2</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">"3vs3"</span><span class="s3">&gt;</span><span class="s1">3 vs 3</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;/</span><span class="s6">select</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">h3</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-lg font-bold mb-4"</span><span class="s3">&gt;</span><span class="s1">Nomi Atleti e Squadra</span><span class="s3">&lt;/</span><span class="s6">h3</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"player-inputs"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s1">&lt;!-- I campi degli atleti verranno generati dinamicamente qui --&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"submit"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full bg-gradient-to-r from-green-500 to-green-600 text-white font-bold py-3 rounded-lg hover:from-green-600 hover:to-green-700 transition-colors duration-300 shadow-lg hover:shadow-xl"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>Crea Sessione</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">form</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- Modale per il Form di Giocata --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"play-form-modal"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"modal fixed inset-0 flex items-center justify-center hidden z-50"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-white p-8 rounded-2xl shadow-2xl max-w-lg w-full transform transition-all duration-300"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex justify-between items-center mb-6"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"play-modal-title"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-2xl font-bold text-gray-800"</span><span class="s3">&gt;</span><span class="s4">Registra Giocata</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"close-play-modal-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-gray-400 text-2xl hover:text-gray-600"</span><span class="s3">&gt;</span><span class="s4">&amp;times;</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">form</span><span class="s1"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"play-form"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"mb-4"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s4"> </span><span class="s2">for</span><span class="s3">=</span><span class="s1">"play-type"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"block text-gray-700 font-bold mb-2"</span><span class="s3">&gt;</span><span class="s4">Tipo di giocata:</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">select</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"play-type"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"</span><span class="s4"> </span><span class="s2">required</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">""</span><span class="s3">&gt;</span><span class="s1">Seleziona</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">"accosto"</span><span class="s3">&gt;</span><span class="s1">Accosto</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">"raffaBoccia"</span><span class="s3">&gt;</span><span class="s1">Raffa alla boccia</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">"raffaPallino"</span><span class="s3">&gt;</span><span class="s1">Raffa al pallino</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">"voloBoccia"</span><span class="s3">&gt;</span><span class="s1">Volo alla boccia</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;/</span><span class="s6">select</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"mb-4"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s4"> </span><span class="s2">for</span><span class="s3">=</span><span class="s1">"play-field-sector"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"block text-gray-700 font-bold mb-2"</span><span class="s3">&gt;</span><span class="s4">Quarto di campo:</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">select</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"play-field-sector"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"</span><span class="s4"> </span><span class="s2">required</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">""</span><span class="s3">&gt;</span><span class="s1">Seleziona</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">"1S"</span><span class="s3">&gt;</span><span class="s1">1S</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">"1C"</span><span class="s3">&gt;</span><span class="s1">1C</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">"1D"</span><span class="s3">&gt;</span><span class="s1">1D</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">"2S"</span><span class="s3">&gt;</span><span class="s1">2S</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">"2C"</span><span class="s3">&gt;</span><span class="s1">2C</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">"2D"</span><span class="s3">&gt;</span><span class="s1">2D</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">"3S"</span><span class="s3">&gt;</span><span class="s1">3S</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">"3C"</span><span class="s3">&gt;</span><span class="s1">3C</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">"3D"</span><span class="s3">&gt;</span><span class="s1">3D</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">"4S"</span><span class="s3">&gt;</span><span class="s1">4S</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">"4C"</span><span class="s3">&gt;</span><span class="s1">4C</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;&lt;</span><span class="s6">option</span><span class="s1"> </span><span class="s2">value</span><span class="s3">=</span><span class="s5">"4D"</span><span class="s3">&gt;</span><span class="s1">4D</span><span class="s3">&lt;/</span><span class="s6">option</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;/</span><span class="s6">select</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"play-details"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"play-details mb-4"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"submit"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white p-3 rounded-lg font-bold hover:from-blue-600 hover:to-blue-700 transition-colors duration-300 shadow-lg hover:shadow-xl"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>Registra Giocata</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">form</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- Vista principale con la lista delle sessioni --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"session-list-view"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"max-w-4xl mx-auto"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex justify-between items-center mb-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-3xl font-bold text-gray-800"</span><span class="s3">&gt;</span><span class="s4">Le mie Sessioni</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"start-new-session-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold py-3 px-6 rounded-full shadow-lg hover:from-blue-600 hover:to-blue-700 transition-colors duration-300 transform hover:scale-105"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>+ Nuova Partita</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"sessions-list"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">&lt;!-- Le sessioni verranno renderizzate qui --&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- Vista della partita singola --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"game-view"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hidden"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"back-to-sessions-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors duration-300 mb-6 shadow-md"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>&amp;larr; Torna a Sessioni</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-gradient-to-r from-blue-50 to-blue-100 p-6 rounded-xl shadow-lg mb-8 text-center"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">h3</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-2xl font-bold text-blue-800 mb-2"</span><span class="s3">&gt;</span><span class="s4">Stato Partita</span><span class="s3">&lt;/</span><span class="s6">h3</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"game-type-display"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-lg text-gray-600"</span><span class="s3">&gt;</span><span class="s4">Tipo di Partita: 1vs1</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"game-phase"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-xl font-semibold text-blue-700"</span><span class="s3">&gt;</span><span class="s4">Fase: 1</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"end-phase-message"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hidden mt-4 p-4 bg-yellow-200 text-yellow-800 rounded-lg font-semibold"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>La fase è terminata! Clicca sul pulsante per avviare la prossima.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex flex-col sm:flex-row justify-center items-center space-y-4 sm:space-y-0 sm:space-x-4 mt-4"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"start-next-phase-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hidden w-full sm:w-auto bg-gradient-to-r from-green-500 to-green-600 text-white font-bold py-3 px-6 rounded-lg hover:from-green-600 hover:to-green-700 transition-colors duration-300 shadow-lg hover:shadow-xl"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>Avvia Prossima Fase</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"cancel-phase-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full sm:w-auto bg-gradient-to-r from-red-500 to-red-600 text-white font-bold py-3 px-6 rounded-lg hover:from-red-600 hover:to-red-700 transition-colors duration-300 shadow-lg hover:shadow-xl"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>Annulla Fase</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex justify-center items-center space-x-4 mb-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"export-csv-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-blue-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors duration-300 shadow-md"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>Esporta in CSV</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"export-pdf-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-purple-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-600 transition-colors duration-300 shadow-md"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>Esporta in PDF</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"players-container"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6"</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">&lt;!-- I giocatori verranno renderizzati qui --&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">main</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">body</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">html</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
</body>
</html>
<!-- fix -->
